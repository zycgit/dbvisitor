---
id: custom-rule
sidebar_position: 6
hide_table_of_contents: true
title: 7.6 Custom Rule
description: When built-in rules are insufficient, extend dbVisitor by defining your own rules.
---
:::tip[Hint]
This article is generated by AI translation.
:::

# Custom Rule

When the built-in rules are not enough, extend dbVisitor with your own rule.

```java title='1. Implement SqlBuildRule'
import net.hasor.dbvisitor.internal.OgnlUtils;
import net.hasor.dbvisitor.dynamic.rule.SqlBuildRule;
public class MyRule implements SqlBuildRule {
    @Override
    public boolean test(SqlArgSource data, DynamicContext context, String activeExpr) {
        return StringUtils.isBlank(activeExpr) || Boolean.TRUE.equals(OgnlUtils.evalOgnl(activeExpr, data));
    }

    @Override
    public void executeRule(SqlArgSource data, DynamicContext context, 
                            SqlBuilder sqlBuilder, String activeExpr, String ruleValue) {
        // activeExpr: activation condition
        // ruleValue : rule content
        ...
        SqlArg arg = new SqlArg(expr, value, sqlMode, jdbcType, javaType, typeHandler);
        sqlBuilder.appendSql("?", arg);
    }
}
```

```java title='2. Register the rule'
RuleRegistry.DEFAULT.register("myrule", new MyRule());
```

```sql title='3. Use the rule'
select * from `test_user` @{myrule, true, xxxx}
```

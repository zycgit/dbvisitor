---
id: custom-rule
sidebar_position: 5
hide_table_of_contents: true
title: 7.4 Custom Rules
description: When dbVisitor built-in rules cannot meet your needs, you can extend the required rules through custom methods.
---

:::tip[Hint]
This article is generated by AI translation.
:::

# Custom Rules

When dbVisitor built-in rules cannot meet your needs, you can extend the required rules through custom methods.

```java title='1. Implement SqlBuildRule interface'
import net.hasor.dbvisitor.internal.OgnlUtils;
import net.hasor.dbvisitor.dynamic.rule.SqlBuildRule;
public class MyRule implements SqlBuildRule {
    @Override
    public boolean test(SqlArgSource data, DynamicContext context, String activeExpr) {
        return StringUtils.isBlank(activeExpr) || Boolean.TRUE.equals(OgnlUtils.evalOgnl(activeExpr, data));
    }

    @Override
    public void executeRule(SqlArgSource data, DynamicContext context, 
                            SqlBuilder sqlBuilder, String activeExpr, String ruleValue) {
        // activeExpr is the activation condition
        // ruleValue is the rule content
        ...
        SqlArg arg = new SqlArg(expr, value, sqlMode, jdbcType, javaType, typeHandler);
        sqlBuilder.appendSql("?", arg);
    }
}
```

```java title='2. Register Rule'
RuleRegistry.DEFAULT.register("myrule", new MyRule());
```

```sql title='3. Use Rule'
select * from `test_user` @{myrule, true, xxxx}
```

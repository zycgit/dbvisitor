---
id: v5.4.0
sidebar_position: 966
title: v5.4.0 (2023-08-24)
---

# v5.4.0 (2023-08-24)

```xml
<dependency>
    <groupId>net.hasor</groupId>
    <artifactId>dbvisitor</artifactId>
    <version>5.4.0</version>
</dependency>
```

## Breaking changes
- `SelectKeyHandler` adds a parameter to mark before/after invocation.
- `KeySeqHolder` adds `onBefore` / `onAfter` to mark stages.
- LambdaTemplate Map mode no longer depends on DB metadata; dbVisitor will not query metadata.
- Reworked `InsertLambda` logic to handle differences between Entity and Map modes.
- Removed `PhoenixDialect`.

## Added
- `@BindTypeHandler` annotation for custom TypeHandlers.
- `URITypeHandler`, `URLTypeHandler`, plus JDBC Types `DATALINK` and `ROWID` support.
- Keyword dictionaries for h2/db2/derby/hive/hsql/impala/informix/sqlite/sqlserver/Dameng/Xugu.
- Mapper files can set `useDelimited`.
- `lambdaUpdate` `UpdateExecute` interface gains Condition methods.
- `DalRegistry` adds two `hasScope` methods to check scope existence.
- Lambda Delete/Insert/Select/Update for Map support `MappingOptions`.

## Improved
- Removed unfinished dbVisitor generate code.
- Upgrade cobble to 4.5.4.
- `IncludeRule` now avoids extra spaces in generated SQL.
- lambda Update/Delete/Query tolerate tableMapping with no matched columns.
- Mapping logic reduces `TableDefaultInfo` construction.
- DTD/XSD validation: `entity.table` optional; if omitted the entity class must have `@Table`.
- Compatibility tweaks for H2 2.2.220.
- Unit tests improved: 834 tests passing, line coverage 77%, class coverage 92%.
- `DalSession.createMapper` no longer requires mapper interfaces to be annotated; auto-detects `DalRegistry`.
- `ExecuteInvocationHandler` aligns default-method handling with MyBatis for Java 8/9.

## Fixed
- Incorrect error messages always showing NPE (thanks to community user aqnghu).
- `lambdaInsert` missing auto-increment backfill when auto column excluded from insert.
- Mapper file-level `MappingOptions` not taking effect (priority: table -> mapper file -> global).
- Oracle `InsertLambda` batch insert failures.
- `SqlXmlForReaderTypeHandler` not working.
- `BaseMapper.updateById` forcing id into updates.
